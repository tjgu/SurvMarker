% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_null.R
\name{plot_null_vs_observed}
\alias{plot_null_vs_observed}
\title{Plot empirical null distribution vs observed score for a single feature}
\usage{
plot_null_vs_observed(
  res,
  feature,
  bins = 30,
  binwidth = NULL,
  title = NULL,
  subtitle = NULL,
  caption = NULL,
  xlab = expression(s[j]^{
     (null)
 }),
  ylab = "Count",
  hist_fill = "lightblue",
  hist_color = "black",
  hist_alpha = 0.9,
  obs_line_color = "red",
  obs_linetype = "dashed",
  obs_linewidth = 1,
  show_obs_label = TRUE,
  obs_label_fmt = "Observed = \%.3f",
  obs_label_y_frac = 0.92,
  show_density = FALSE,
  density_color = "black",
  density_linewidth = 1,
  theme_fn = ggplot2::theme_minimal,
  base_size = 14,
  title_size = 18,
  axis_title_size = 14,
  axis_text_size = 12,
  legend_title_size = 12,
  legend_text_size = 11,
  legend_position = "right",
  panel_grid = TRUE,
  panel_border = FALSE,
  ...
)
}
\arguments{
\item{res}{Result from \code{pca_based_weighted_score(store_null=TRUE)}.
Must contain \code{feature_table} and \code{null_scores}.}

\item{feature}{feature name (must be in \code{res$feature_table$feature} and \code{rownames(res$null_scores)}).}

\item{bins}{Integer number of bins for histogram (default 30).}

\item{binwidth}{Optional numeric bin width. If provided, \code{binwidth} overrides \code{bins}.}

\item{title}{Optional title; if NULL, a default title including p_emp is used.}

\item{subtitle}{Optional subtitle.}

\item{caption}{Optional caption.}

\item{xlab}{X-axis label (default expression).}

\item{ylab}{Y-axis label.}

\item{hist_fill}{Histogram fill color.}

\item{hist_color}{Histogram border color.}

\item{hist_alpha}{Histogram transparency.}

\item{obs_line_color}{Color of observed vertical line.}

\item{obs_linetype}{Linetype for observed vertical line.}

\item{obs_linewidth}{Line width for observed vertical line.}

\item{show_obs_label}{Logical; if TRUE, label the observed score line.}

\item{obs_label_fmt}{Format string for observed label (uses \code{sprintf} with one numeric argument).}

\item{obs_label_y_frac}{Placement of observed label as a fraction of y-range.}

\item{show_density}{Logical; if TRUE, overlay a density curve for the null distribution.}

\item{density_color}{Density line color.}

\item{density_linewidth}{Density line width.}

\item{theme_fn}{ggplot theme function (e.g., \code{ggplot2::theme_minimal}, \code{ggplot2::theme_classic}).}

\item{base_size, title_size, axis_title_size, axis_text_size, legend_title_size, legend_text_size}{Font sizes.}

\item{legend_position}{Legend position.}

\item{panel_grid}{Logical; show grid lines.}

\item{panel_border}{Logical; draw a border.}

\item{...}{Additional ggplot layers to add (e.g., \code{theme()}, \code{scale_x_continuous()}, etc.).}
}
\value{
A ggplot object.
}
\description{
Draws a histogram of the empirical null scores for one feature and overlays
the observed score as a vertical line. Users can fully customize appearance
via arguments and by passing additional ggplot layers through \code{...}.
}
\examples{
# Basic:
# plot_null_vs_observed_feature(res, feature="TAL1")
#
# Custom colors + bins:
# plot_null_vs_observed_feature(res, "TAL1", bins=40, hist_fill="grey85", obs_line_color="red")
#
# Add any ggplot styling via ...
# plot_null_vs_observed_feature(res, "TAL1",
#   ggplot2::theme_classic(base_size=16),
#   ggplot2::coord_cartesian(xlim=c(-2,2))
# )
}
