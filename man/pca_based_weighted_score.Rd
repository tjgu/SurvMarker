% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pca_based_weighted_score.R
\name{pca_based_weighted_score}
\alias{pca_based_weighted_score}
\title{Survival-based loading-based feature scoring with empirical null}
\usage{
pca_based_weighted_score(
  X,
  time,
  status,
  covar = NULL,
  n_pcs = 50,
  cumvar_threshold = NULL,
  max_pcs = 50,
  pc_fdr_cutoff = 0.05,
  feature_fdr_cutoff = 0.05,
  null_B = 500,
  seed = 1,
  scale_pca = TRUE,
  use_abs_loadings = TRUE,
  store_null = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{X}{Numeric matrix/data.frame (n_samples x p_features). Rows=samples, cols=features.}

\item{time}{Numeric survival times (same order as rows of X).}

\item{status}{Event indicator (0/1). 1=event, 0=censored.}

\item{covar}{Optional data.frame of covariates (n_samples rows).}

\item{n_pcs}{Integer or NULL. If provided, use first n_pcs PCs (default 50).}

\item{cumvar_threshold}{Numeric in (0,1] or NULL. If provided, choose smallest K such that
cumulative variance explained >= cumvar_threshold. If both n_pcs and cumvar_threshold
are provided, cumvar_threshold takes precedence.}

\item{max_pcs}{Hard cap on number of PCs allowed (safety cap; default 50).}

\item{pc_fdr_cutoff}{FDR cutoff for selecting survival-associated PCs (default 0.05).}

\item{feature_fdr_cutoff}{FDR cutoff for selecting features from empirical null (default 0.05).}

\item{null_B}{Number of null resamples (default 500).}

\item{seed}{Random seed.}

\item{scale_pca}{Scale features in PCA.}

\item{use_abs_loadings}{Use |loading| in score definition.}

\item{store_null}{If TRUE, return full null score matrix (features x B).}

\item{verbose}{Logical.}
}
\value{
List with feature_table (feature, loading_* for each significant PC, sj, p_emp, fdr),
pc_table, pca, pc_scores, null_scores (optional), selected_features, settings.
}
\description{
Survival-based loading-based feature scoring with empirical null
}
